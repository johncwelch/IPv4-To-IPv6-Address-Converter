property ip6tablesPart1 : "ip6tables -A INPUT -s 0:0:0:0:0:ffff:"property ip6tablesPart2 : " -j DROP
"property ip6tablesList : {}property ip6tablesStatement : ""global conversionScriptglobal ipv6AddressBitglobal theOctetset ipv6AddressBit to ""set theOctet to ""set theFile to choose file with prompt "pick the list of IPv4 addresses"set theFileHandle to open for access theFile without write permissionset the ipv4Addresses to read theFileHandleclose access theFileHandleset the ipv4AddressesList to every paragraph in ipv4Addressesset saveTID to AppleScript's text item delimitersset AppleScript's text item delimiters to {"."}repeat with x in ipv4AddressesList	set theOctet to the first text item of x as integer	set ipv6AddressBit to ipv6AddressBit & (do shell script "perl -e 'printf(\"%x\", " & theOctet & ")'")	set theOctet to second text item of x as integer	set ipv6AddressBit to ipv6AddressBit & (do shell script "perl -e 'printf(\"%x\", " & theOctet & ")'")	set ipv6AddressBit to ipv6AddressBit & ":"	set theOctet to third text item of x as integer	set ipv6AddressBit to ipv6AddressBit & (do shell script "perl -e 'printf(\"%x\", " & theOctet & ")'")	set theOctet to fourth text item of x as integer	set ipv6AddressBit to ipv6AddressBit & (do shell script "perl -e 'printf(\"%x\", " & theOctet & ")'")	set ip6tablesStatement to ip6tablesPart1 & ipv6AddressBit & ip6tablesPart2	set the end of ip6tablesList to ip6tablesStatement	set ipv6AddressBit to ""end repeatset AppleScript's text item delimiters to saveTIDset theip6tablestext to ip6tablesList as textset theip6tablesfile to choose file name with prompt "enter the name for the list of ip6tables statements"set theip6tablesfilehandle to open for access theip6tablesfile with write permissionwrite theip6tablestext to theip6tablesfilehandleclose access theip6tablesfilehandleset ipv4AddressesList to {}set ip6tablesList to {}set ip6tablesStatement to ""